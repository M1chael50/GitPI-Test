major changes in this file